# JSON API

## 概要

P2P地震情報 JSON APIでは，P2P地震情報ネットワーク上に配信された「地震情報」「津波予報」「地震感知情報」の取得が可能です。

APIは，フォーマットにJSON，文字コードにUTF-8を使用しています。

## 基本仕様

- URI: https://api.p2pquake.net/v1
- リクエストメソッド: GET

## API: GET /human-readable

このAPIは，地震情報，津波予報と，集計された地震感知情報を提供します。

### サンプル

一部のヘッダ情報は省略しています。

```
> GET /v1/human-readable?limit=3 HTTP/1.1

< HTTP/1.1 200 OK
< Content-Type: application/json;charset=utf-8
< 
< [{"time":"2014/09/23 20:09:18.192","code":551,"issue":{"type":"DetailScale","source":null},"earthquake":{"time":"24日20時05分","maxScale":10,"domesticTsunami":"None","hypocenter":{"name":"長野県南部","depth":"ごく浅い","magnitude":"2.2","latitude":"N35.8","longitude":"E137.7"}},"points":[{"scale":10,"addr":"木曽町"}]},{"time":"2014/09/23 19:30:25.306","code":551,"issue":{"type":"DetailScale","source":null},"earthquake":{"time":"23日19時26分","maxScale":10,"domesticTsunami":"None","hypocenter":{"name":"島根県西部","depth":"10km","magnitude":"2.6","latitude":"N35.1","longitude":"E132.6"}},"points":[{"scale":10,"addr":"島根美郷町"}]}]
```

### パラメタ

フィールド名|必須|内容
--|--|--
limit|no|取得件数 (1～100, デフォルトは10)

### レスポンス

レスポンスのJSONは配列です。配信が新しい順にソートされています。配列の各要素はオブジェクト（連想配列）になっており，オブジェクトは必ず次のキーを持ちます。


キー名|必須|値の型|内容
--|--|--|--
time|yes|文字列|情報の配信日時で，yyyy/MM/dd HH:mm:ss.SSS形式。地震感知情報については，集計の始点となる日時。
code|yes|数値|情報の種類。 551: 地震情報，552: 津波予報，5610: 集計済み地震感知情報。

#### code 551: 地震情報

```
{
    "time": "2014/09/27 01:46:27.393", 
    "code": 551, 
    "issue": {
        "source": null, 
        "type": "DetailScale"
    }, 
    "earthquake": {
        "time": "27日01時40分", 
        "hypocenter": {
            "name": "茨城県沖", 
            "latitude": "N36.4", 
            "longitude": "E141.1", 
            "depth": "40km", 
            "magnitude": "3.5"
        }, 
        "maxScale": 10, 
        "domesticTsunami": "None"
    }, 
    "points": [
        {
            "addr": "日立市", 
            "scale": 10
        }, 
        {
            "addr": "高萩市", 
            "scale": 10
        }
    ]
}
```

キー|必須|値の型|値の内容
--|--|--|--
issue|yes|object|発表に関する情報を持ちます。
issue.source|no|string|発表元を表します。一部発表では値がnullになっていることがあります。
issue.type|yes|string|発表種類を表します。値は、ScalePrompt(震度速報)、Destination(震源に関する情報)、ScaleAndDestination(震度・震源に関する情報)、DetailScale(各地の震度に関する情報)、Foreign(遠地地震に関する情報)、Other(その他の情報)のいずれかが入ります。
earthquake|yes|object|地震に関する情報を持ちます。
earthquake.time|yes|string|発生日時を表します。
earthquake.hypocenter|(*1)|object|震源を表します。
earthquake.hypocenter.name|(*1)|string|震源地名を表します。
earthquake.hypocenter.latitude|(*1)|string|緯度を表します。Nは北緯、Sは南緯を表します。
earthquake.hypocenter.longitude|(*1)|string|経度を表します。Eは東経、Wは西経を表します。
earthquake.hypocenter.depth|(*1)|string|深さを表します。取得失敗時は「ごく浅い」が入ることがあります。
earthquake.hypocenter.magnitude|(*1)|string|マグニチュードを表します。取得失敗時は「-1.0」となります。
earthquake.maxScale|(*2)|number|最大震度を表します。値は、0(なし)、10(震度1)、20(2)、30(3)、40(4)、45(5弱)、50(5強)、55(6弱)、60(6強)、70(7)のいずれかです。
earthquake.domesticTsunami|(*3)|string|国内への津波の有無を表します。値は、None(なし)、Unknown(不明)、Checking(調査中)、NonEffective(若干の海面変動[被害の心配なし])、Watch(津波注意報)、Warning(津波予報[種類不明])のいずれかです。
points|(*4)|array|震度観測点に関する情報を持ちます。
points[x].addr|yes|string|震度観測点名を表します。
points[x].scale|yes|number|震度を表します。値は、earthquake.maxScaleと同様です。ただし、46(5弱以上と推定されるが震度情報を入手していない)を含みます。

(\*1)から(\*4)については、発表種類(issue.type)によって含まれるかどうかが決まります。

項目名|ScalePrompt|Destination|ScaleAndDestination|DetailScale|Foreign|Other
--|:--:|:--:|:--:|:--:|:--:|:--:
*1 (震源)|×|○|○|○|○|×
*2 (最大震度)|○|×|○|○|×|×
*3 (国内津波)|×|○|○|○|○|×
*4 (震度観測点)|○|×|(*5)|(*5)|×|×

(*5) 空の配列になることがあります（震度を観測していないが、津波予報が発表された場合など）。

※「×」の項目は、取得結果に存在しても、値に意味はありません。

#### code 552: 津波予報

```
{
    "time": "2015/05/03 02:41:54.062",
    "code": 552,
    "issue": {
        "type": "Focus"
    },
    "cancelled": false,
    "areas": [
        {
            "name": "伊豆諸島",
            "grade": "Watch",
            "immediate": true
        },
        {
            "name": "小笠原諸島",
            "grade": "Watch",
            "immediate": true
        }
    ]
}
```

キー|必須|値の型|値の内容
--|--|--|--
issue|yes|object|発表に関する情報を持ちます。
issue.type|yes|string|発表種類を表します。津波予報は focus または Focus です。
cancelled|yes|true/false|津波予報の解除かどうかを表します。
areas|(*1)|array|津波予報の予報区ごとの情報を表します。
areas[x].name|yes|string|津波予報区名を表します。津波予報区の一覧は、気象庁｜津波予報区についてにあります。
areas[x].grade|yes|string|津波予報の種類を表します。値は、MajorWarning(大津波警報)、Warning(津波警報)、Watch(津波注意報)、Unknown(不明)のいずれかが入ります。
areas[x].immediate|yes|true/false|直ちに津波が来襲すると予想されているかどうかを表します。

(*1) cancelled: trueの場合、areasは存在しないか空の配列になります。

#### code 5610: 集計済み地震感知情報

```
{
    "time": "2014/09/27 01:41:13.992", 
    "code": 5610, 
    "count": 9, 
    "areas": {
        "栃木南部": 1, 
        "神奈川東部": 1, 
        "福島中通り": 2, 
        "茨城北部": 4, 
        "茨城南部": 1
    }, 
    "prefs": {
        "栃木": 1, 
        "神奈川": 1, 
        "福島": 2, 
        "茨城": 5
    }, 
    "regions": {
        "東北": 2, 
        "関東": 7
    }
}
```

キー|必須|値の型|値の内容
--|--|--|--
count|yes|number|集計件数を表します。
areas|yes|object|P2P地震情報が定める地域単位での集計結果を持ちます。
areas.地域名|yes|number|その地域から発信された地震感知情報の件数を表します。
prefs|yes|object|都道府県単位での集計結果を持ちます。
prefs.都道府県名|yes|number|その都道府県から発信された地震感知情報の件数を表します。
regions|yes|object|地方単位での集計結果を持ちます。
regions.地方名|yes|number|その地方から発信された地震感知情報の件数を表します。

なお，地域名・都道府県名・地方名の対応は下記の通りです。

地域名|都道府県名|地方名
--|--|--
地域未設定|未設定|未設定
地域不明|不明|不明
日本以外|外国|外国
北海道 石狩|北海道|北海道
北海道 渡島|北海道|北海道
北海道 檜山|北海道|北海道
北海道 後志|北海道|北海道
北海道 空知|北海道|北海道
北海道 上川|北海道|北海道
北海道 留萌|北海道|北海道
北海道 宗谷|北海道|北海道
北海道 網走|北海道|北海道
北海道 胆振|北海道|北海道
北海道 日高|北海道|北海道
北海道 十勝|北海道|北海道
北海道 釧路|北海道|北海道
北海道 根室|北海道|北海道
青森津軽|青森|東北
青森三八上北|青森|東北
青森下北|青森|東北
岩手沿岸北部|岩手|東北
岩手沿岸南部|岩手|東北
岩手内陸|岩手|東北
宮城北部|宮城|東北
宮城南部|宮城|東北
秋田沿岸|秋田|東北
秋田内陸|秋田|東北
山形庄内|山形|東北
山形最上|山形|東北
山形村山|山形|東北
山形置賜|山形|東北
福島中通り|福島|東北
福島浜通り|福島|東北
福島会津|福島|東北
茨城北部|茨城|関東
茨城南部|茨城|関東
栃木北部|栃木|関東
栃木南部|栃木|関東
群馬北部|群馬|関東
群馬南部|群馬|関東
埼玉北部|埼玉|関東
埼玉南部|埼玉|関東
埼玉秩父|埼玉|関東
千葉北東部|千葉|関東
千葉北西部|千葉|関東
千葉南部|千葉|関東
東京|東京|関東
伊豆諸島北部|東京|関東
伊豆諸島南部|東京|関東
小笠原|東京|関東
神奈川東部|神奈川|関東
神奈川西部|神奈川|関東
新潟上越|新潟|北陸
新潟中越|新潟|北陸
新潟下越|新潟|北陸
新潟佐渡|新潟|北陸
富山東部|富山|北陸
富山西部|富山|北陸
石川能登|石川|北陸
石川加賀|石川|北陸
福井嶺北|福井|北陸
福井嶺南|福井|北陸
山梨東部|山梨|甲信
山梨中・西部|山梨|甲信
長野北部|長野|甲信
長野中部|長野|甲信
長野南部|長野|甲信
岐阜飛騨|岐阜|東海
岐阜美濃|岐阜|東海
静岡伊豆|静岡|東海
静岡東部|静岡|東海
静岡中部|静岡|東海
静岡西部|静岡|東海
愛知東部|愛知|東海
愛知西部|愛知|東海
三重北中部|三重|東海
三重南部|三重|東海
滋賀北部|滋賀|近畿
滋賀南部|滋賀|近畿
京都北部|京都|近畿
京都南部|京都|近畿
大阪北部|大阪|近畿
大阪南部|大阪|近畿
兵庫北部|兵庫|近畿
兵庫南部|兵庫|近畿
奈良|奈良|近畿
和歌山北部|和歌山|近畿
和歌山南部|和歌山|近畿
鳥取東部|鳥取|中国
鳥取中・西部|鳥取|中国
島根東部|島根|中国
島根西部|島根|中国
島根隠岐|島根|中国
岡山北部|岡山|中国
岡山南部|岡山|中国
広島北部|広島|中国
広島南部|広島|中国
山口北部|山口|中国
山口中・東部|山口|中国
山口西部|山口|中国
徳島北部|徳島|四国
徳島南部|徳島|四国
香川|香川|四国
愛媛東予|愛媛|四国
愛媛中予|愛媛|四国
愛媛南予|愛媛|四国
高知東部|高知|四国
高知中部|高知|四国
高知西部|高知|四国
福岡福岡|福岡|九州北
福岡北九州|福岡|九州北
福岡筑豊|福岡|九州北
福岡筑後|福岡|九州北
佐賀北部|佐賀|九州北
佐賀南部|佐賀|九州北
長崎北部|長崎|九州北
長崎南部|長崎|九州北
長崎壱岐・対馬|長崎|九州北
長崎五島|長崎|九州北
熊本阿蘇|熊本|九州北
熊本熊本|熊本|九州北
熊本球磨|熊本|九州北
熊本天草・芦北|熊本|九州北
大分北部|大分|九州北
大分中部|大分|九州北
大分西部|大分|九州北
大分南部|大分|九州北
宮崎北部平野部|宮崎|九州南
宮崎北部山沿い|宮崎|九州南
宮崎南部平野部|宮崎|九州南
宮崎南部山沿い|宮崎|九州南
鹿児島薩摩|鹿児島|九州南
鹿児島大隅|鹿児島|九州南
鹿児島薩摩|鹿児島|九州南
種子島・屋久島|鹿児島|九州南
鹿児島奄美|鹿児島|九州南
沖縄本島北部|沖縄|沖縄
沖縄本島中南部|沖縄|沖縄
沖縄久米島|沖縄|沖縄
沖縄大東島|沖縄|沖縄
沖縄宮古島|沖縄|沖縄
沖縄八重山|沖縄|沖縄

## 補足事項

- リクエスト数が過大とならないよう配慮をお願いします。

- IPアドレス単位でおよそ 30リクエスト/分 を超える場合，アクセスを制限する可能性があります。

## 変更履歴

2017/09/18
- httpsスキームによる接続に対応しました。httpスキームも引き続き対応しています。
- ホストをapi.p2pquake.comからapi.p2pquake.netに変更しました。api.p2pquake.comも引き続き対応しています。
